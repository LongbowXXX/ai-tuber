# ドキュメント整合性チェックプロンプト作成

**日時:** 2025 年 11 月 24 日  
**目的:** プロジェクトドキュメントの整合性をチェック・修正するためのカスタムプロンプトファイルを作成する

---

## 概要

VS Code のカスタムプロンプトファイル機能を活用し、プロジェクトドキュメント全体の整合性を体系的にチェックするプロンプトを作成しました。README.md を起点として、リンク切れ、DRY 原則違反、実装との矛盾を検出し、修正提案または即座の修正を行うエージェントプロンプトです。

---

## 対話の流れ

### 1. 最初の依頼

**ユーザー:**

- `create-custom-prompt.prompt.md` の指示に従って、プロジェクトドキュメントの整合性チェック・修正のためのプロンプトを作成してほしい
- 要件:
  - README.md から読み進めることでプロジェクト全体が理解できること
  - 利用者視点で整合性が取れていること
  - DRY 原則が守られていること
  - 実装との矛盾がないこと

**Copilot の応答:**

1. VS Code カスタムプロンプトファイルの公式ドキュメントを fetch_webpage で取得
2. ドキュメントの仕様を理解し、要件を分析
3. 以下の設計でプロンプトを提案:
   - **エージェント:** `agent` (ファイル操作、分析、修正が必要なため)
   - **ツール:** 無指定(grep、ファイル読み込み、編集など多様なツールが必要)
   - **スコープ:** ワークスペース(プロジェクト固有のドキュメント構造)

### 2. プロンプト内容の確認

**ユーザー:**
「作成して」

**Copilot の応答:**
`.github/prompts/check-doc-consistency.prompt.md` にプロンプトファイルを作成し、使い方を説明しました。

---

## 重要なポイント

- **コンテキストの与え方:**

  - プロジェクトの `.github/copilot-instructions.md` が既に読み込まれており、プロジェクト構造やルールが理解されていた
  - `create-custom-prompt.prompt.md` を参照することで、公式ドキュメントの取得から始める標準フローを実行

- **効果的だった指示:**

  - 要件を箇条書きで明確に提示(README からたどれる、DRY、実装との整合性)
  - メタプロンプト(`create-custom-prompt.prompt.md`)を活用し、VS Code の最新仕様に基づいたプロンプト生成を実現

- **改善点:**
  - 特になし。メタプロンプトによる標準化されたワークフローがスムーズに機能

---

## 成果物

### 作成されたファイル

**`.github/prompts/check-doc-consistency.prompt.md`**

主な機能:

1. **4 つのチェック観点**

   - ドキュメント構造の完全性(リンク切れ、たどりやすさ)
   - DRY 原則の遵守(重複コンテンツの検出と一元化)
   - 実装との整合性(コード、pyproject.toml、ディレクトリ構造)
   - プロジェクト固有ルール(copilot-instructions.md に基づく検証)

2. **体系的な実行手順**

   - README.md → リンク先 → agents-docs/ → 実装の順で段階的にチェック
   - 問題のリストアップと優先度分類(✅ 問題なし、⚠️ 修正推奨、❌ 修正必須、🔄DRY 違反)

3. **実用的な出力形式**
   - チェック結果サマリーのテンプレート提供
   - 軽微な修正は即座に実施、構造的変更は提案として提示

### 使用方法

チャットで `/check-doc-consistency` と入力するだけで、プロジェクト全体のドキュメント整合性チェックが実行されます。

---

## 学んだこと・Tips

- **メタプロンプトの価値:**

  - `create-custom-prompt.prompt.md` のようなプロンプト作成ガイドを用意しておくことで、公式ドキュメント取得から始まる標準化されたワークフローを確立できる
  - これにより、常に最新の VS Code 仕様に基づいたプロンプトが生成される

- **agent vs ask の使い分け:**

  - ファイル操作や複雑な分析タスクには `agent` を選択
  - 質問応答や説明には `ask` が適している
  - 今回はファイル読み込み・編集・検索が必要なため `agent` が適切

- **DRY 原則のドキュメント適用:**

  - コードだけでなく、ドキュメントにも DRY 原則を適用することで保守性が向上
  - 共通情報は一箇所に集約し、他はリンクで参照する設計

- **段階的チェックの重要性:**

  - README → リンク先 → 詳細ドキュメント → 実装という順序で検証することで、利用者の理解経路に沿ったチェックが可能

- **プロジェクト固有のコンテキスト活用:**
  - `.github/copilot-instructions.md` に記載されたプロジェクトルールを参照することで、より精度の高いチェックが可能

---

## タグ

`#VSCode` `#CopilotPrompt` `#ドキュメント` `#品質管理` `#DRY原則` `#vtuber-behavior-engine` `#メタプロンプト`
