# コンテキスト管理: AI へ与える文脈の技法

> **「AI は、あなたが与えるコンテキストと同じだけ賢い」**

このドキュメントは、GitHub Copilot やその他の AI ツールに提供するコンテキストを効果的に管理し、可能な限り良い結果を得る方法を説明します。

## 1. Neighboring Tabs（暗黙コンテキスト）

GitHub Copilot は、VS Code のタブで開いているファイル（および最近アクティブだったファイル）を自動的に読み取り、あなたが取り組んでいる内容の文脈を理解します。これを **「Neighboring Tabs」** と呼びます。

### ベストプラクティス

- **関連ファイルを開く**: 特定の Type/Interface を使う関数に取り組んでいるなら、その Type を定義しているファイルをタブで開いておく。
- **テストを開く**: 実装コードを書くときは、対応するテストファイルも開いておく。Copilot はテストから期待挙動を推測します。
- **無関係なファイルを閉じる**: 別タスク（例: 別機能、レガシーコード）のタブを 20 個開いていると、Copilot が混乱して無関係な文脈を引いてくることがあります。**不要なタブは閉じてください。**

## 2. @workspace vs #file（明示コンテキスト）

Copilot Chat では、コンテキストを明示的に制御できます。

### `@workspace`（スカウト）

- **何をするか:** プロジェクト全体のインデックス（ベクターデータベース）を検索して関連情報を見つける。
- **使いどころ:**
  - "Where is the authentication logic defined?"
  - "How do we handle logging in this project?"
  - "Find all usages of `UserDTO`."
- **長所:** 場所が分からないものでも見つけられる。
- **短所:** キーワード一致が不完全だと取りこぼすことがある/似て非なるファイルに気を取られることがある。

### `#file`（スナイパー）

- **何をするか:** 特定ファイルの内容を、プロンプトコンテキストへ明示的に追加する。
- **使いどころ:**
  - "Refactor `#UserService.ts` to use `#Result.ts` for error handling."
  - "Write a unit test for `#PaymentController.ts`."
- **長所:** 話題にしているコードを AI が確実に「見る」。精度が最も高い。
- **短所:** どのファイルが関連するかをあなたが知っている必要がある。

### 比較表

| 特性             | `@workspace`                             | `#file`                           |
| :--------------- | :--------------------------------------- | :-------------------------------- |
| **範囲**         | プロジェクト全体                         | 特定ファイル                      |
| **主体**         | AI が読むものを決める                    | 人間が読むものを決める            |
| **精度**         | 探索に強い                               | 実装に最適                        |
| **ユースケース** | "Search", "Find", "Explain Architecture" | "Refactor", "Debug", "Write Test" |

### `#codebase` について

古いドキュメントや他の AI ツールでは `#codebase` への言及を見るかもしれません。現行の GitHub Copilot for VS Code では、**`@workspace`** が標準エージェントコマンドであり、実質的に `#codebase` 変数の代替です。

- **`@workspace`**: コードベースを検索するアクティブなエージェント。
- **`#codebase`**: しばしば非推奨、または「全ファイル」を意味する代替変数。

**経験則:** 広い問い合わせは常に `@workspace` から始める。

## まとめ

1.  **受動的コンテキスト**: タブをクリーンに保つ。現在タスクに関係するものだけを開く。
2.  **能動的コンテキスト**:

- `@workspace` で情報を **探す**。
- `#file` でコーディングタスクのための具体情報を **与える**。
