# Environment-Agnostic Tool Support（環境非依存のツールサポート）

## 問題

GitHub Copilot の公式ベストプラクティスでは、エージェントやプロンプトで利用可能な `tools` を明示的に定義することが推奨されます。しかし、プロンプトを自動生成する場合、このアプローチには大きな欠点があります:

- **環境の多様性**: 開発者の環境は大きく異なります（拡張機能や MCP サーバーが異なる）。ツールをハードコードすると、ユーザーが導入しているかもしれないコンテキスト固有ツールへのアクセスを意図せず無効化してしまいます。
- **ハルシネーション**: AI モデルは、実在しないツール名をハルシネーションしたり誤った名前を使ったりしがちで、プロンプトの破綻やエラーにつながります。

AI 生成プロンプトが `tools` のリストを明示的にハードコードすると、柔軟性が低下し、無効なツールを含めるリスクが高まります。

## 解決策

新しいカスタムプロンプトやエージェントを生成するときは、ツールを明示的に指定するベストプラクティスを **意図的に無視** します。代わりに `tools` プロパティを完全に省略します。これにより既定の挙動が適用され、通常は現在のコンテキストで利用可能なすべてのツール（拡張機能や MCP サーバー由来のツールを含む）へアクセスできるようになります。

**例外**: 特定の既存リファレンス（例: 厳格なエージェント定義）をベースに新しいプロンプトを作る場合は、そのリファレンスの意図した挙動を維持するために `tools` リストをコピーしても構いません。

## 実装手順

1.  **`tools` プロパティを省略する**:
    `.prompt.md` や `.agent.md` を作成するとき、`tools: [...]` セクションを生成しません。

2.  **ユーザーへ委譲する**:
    特定ツールを制限したり厳密に管理したりする必要がある場合、その設定は人間のユーザーに任せます。

## テンプレ例

**避ける（厳格なリファレンスをコピーする場合を除く）:**

```markdown
---
name: My Strict Agent
description: An agent with hardcoded tools
tools: ["search", "fetch"]
---
```

**推奨（環境非依存）:**

```markdown
---
name: My Flexible Agent
description: An agent that can use whatever tools the user has installed.
---
```

## 利点

- **柔軟性**: 拡張機能や MCP サーバーで追加された新しいツールを、コード変更なしで自動的に利用できます。
- **可搬性**: ツールの不足/追加によって壊れることなく、異なる開発環境でもプロンプトが動作します。
- **能力**: エージェントがユーザーの IDE の能力を最大限活用できます。
